/* jce - 2.9.3 | 2021-02-25 | https://www.joomlacontenteditor.net | Copyright (C) 2006 - 2021 Ryan Demmer. All rights reserved | GNU/GPL Version 2 or later - http://www.gnu.org/licenses/gpl-2.0.html */
function IeCursorFix(){return!0}function jInsertEditorText(text,editor){try{WFEditor.insert(editor,text)}catch(e){}}!function(){function isHidden(el){return"string"==typeof el&&(el=document.getElementById(el)),el&&"none"===el.style.display}function http_build_query(params){return Object.keys(params).map(function(k){return encodeURIComponent(k)+"="+encodeURIComponent(params[k])}).join("&")}var svgToggleIcon='<svg version="1.1" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 448 448"><title></title><g id="wf-toggle-icon" stroke="none" stroke-width="1"></g><path d="M280 64.132v59.482c15.84 6.914 30.406 16.803 42.995 29.391 26.443 26.442 41.005 61.6 41.005 98.995s-14.563 72.552-41.005 98.995c-26.442 26.442-61.599 41.005-98.995 41.005s-72.552-14.563-98.995-41.005c-26.442-26.442-41.005-61.6-41.005-98.995s14.563-72.552 41.005-98.995c12.589-12.589 27.155-22.478 42.995-29.392v-59.481c-80.959 24.097-140 99.082-140 187.868 0 108.248 87.753 196 196 196s196-87.752 196-196c0-88.786-59.041-163.77-140-187.868zM196 0h56v224h-56z"></path></svg>',each=tinymce.each,DOM=tinymce.DOM,Event=tinymce.dom.Event,Dispatcher=tinymce.util.Dispatcher,Joomla=window.Joomla||{},WFEditor={bookmark:null,options:{},getSite:function(base){var site,host,u=document.location.href;return base.indexOf("http")!==-1?(host=base.substr(base.indexOf("://")+3),site=host.substr(host.indexOf("/"))):site=u.substr(0,u.indexOf(base)+base.length),u.indexOf("/administrator/")!==-1&&(site+="administrator/"),site},init:function(settings){var base=settings.base_url,site=this.getSite(base);/https:\/\//.test(document.location.href)&&(base=base.replace(/http:/,"https:")),settings.token=settings.token||0,settings.context=settings.context||"",window.tinyMCEPreInit={},tinymce.extend(tinymce,{baseURL:base+"components/com_jce/editor/tiny_mce",suffix:"",query:http_build_query(settings.query)});var indent="p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr,section,article,hgroup,aside,figure,object,video,audio";if(this.settings=tinymce.extend({document_base_url:base,site_url:site,mode:"textareas",schema:"mixed",relative_urls:!0,entity_encoding:"raw",editor_selector:"wf-editor",editor_deselector:"wf-no-editor",urlconverter_callback:"WFEditor.convertURL",popup_css:!1,add_form_submit_trigger:!1,submit_patch:!1,theme:"none",skin_directionality:"ltr",invalid_elements:"applet,iframe,object,embed,script,style,body,bgsound,base,basefont,frame,frameset,head,html,id,ilayer,layer,link,meta,name,title,xml",plugins:"",external_plugins:{},whitespace_elements:"pre,script,style,textarea,code",allow_conditional_comments:!0,allow_event_attributes:!1,fix_list_elements:!0,indent_before:indent,indent_after:indent,popup_css:!1,keep_styles:!1,update_styles:!0,constrain_menus:!1,compress:{css:!0,javascript:!0},language_load:!1},settings),this.settings)try{var s=this.settings;if(s.compress.css&&tinymce.extend(this.settings,{content_css:!1,editor_css:!1}),this._markLoaded(),s.skip_plugin_languages){var sl=tinymce.ScriptLoader,URI=tinyMCE.baseURI;each(s.skip_plugin_languages.split(","),function(n){n&&(sl.markDone(URI.toAbsolute("plugins/"+n+"/langs/"+s.language+".js")),sl.add(URI.toAbsolute("plugins/"+n+"/langs/en.js")))})}WFEditor.load()}catch(e){}},_markLoaded:function(){function load(u){tinymce.ScriptLoader.markDone(tinyMCE.baseURL+"/"+u)}var s=this.settings,each=tinymce.each,ln=s.language.split(","),suffix=s.suffix||"";1==s.compress.javascript&&(each(s.external_plugins,function(url,name){load(url)}),each(s.plugins.split(","),function(n){n&&(load("plugins/"+n+"/editor_plugin"+suffix+".js"),each(ln,function(c){c&&load("plugins/"+n+"/langs/"+c+".js")}))})),each(["core","help","autolink","cleanup","code","format","importcss","colorpicker","upload","figure","ui","noneditable","branding"],function(n){load("plugins/"+n+"/editor_plugin"+suffix+".js")})},setBookmark:function(ed){function isHidden(ed){return ed.isHidden()||"hidden"==DOM.getStyle(ed.id+"_ifr","visibility")}function isEditor(el){return DOM.getParent(el,"div.mceEditor, div.mceSplitButtonMenu, div.mceListBoxMenu, div.mceDropDown")}Event.add(document.body,"mousedown",function(e){var el=e.target;if(!isEditor(el)&&!isHidden(ed)&&ed.selection){var n=ed.selection.getNode();DOM.getParent(n,"body#tinymce")&&(ed.lastSelectionBookmark=ed.selection.getBookmark(1))}})},load:function(){function _load(){if(!loaded)return loaded=!0,self.preinit()}var loaded,self=this,s=this.settings;Joomla.getOptions&&(s=tinymce.extend(s,Joomla.getOptions("plg_editor_jce",{}))),tinymce.settings=s,tinyMCE.onAddEditor.add(function(mgr,ed){var el=ed.getElement();Joomla.editors&&(Joomla.editors.instances[ed.id]={getValue:function(){return self.getContent(ed.id)},setValue:function(value){self.setContent(ed.id,value)},getSelection:function(){return self.getSelection(ed.id,{format:"text"})},replaceSelection:function(value){return self.insert(ed.id,value)},disable:function(disabled){return ed.setMode(disabled?"readonly":"design")},id:ed.id,instance:ed,onSave:function(){}}),s.compress.css&&ed.onPreInit.add(function(){ed.dom.loadCSS(s.site_url+"index.php?option=com_jce&task=editor.pack&type=css&layout=content")}),"advanced"===s.theme&&(self._createToggle(el),self._createTabs(ed)),self.setBookmark(ed),ed.onInit.add(function(){ed.onSubmit.addToTop(function(){ed.initialized&&(ed.isNotDirty=1,self.getContent(ed.id))});var bookmark=sessionStorage.getItem(ed.id+"_bookmark");bookmark&&ed===tinymce.activeEditor&&window.setTimeout(function(){self.setActiveLine(ed,bookmark)},10)}),ed.onBeforeRenderUI.add(function(){var n=ed.getElement().form;n&&!n._mceOldSubmit&&(n.submit.nodeType||n.submit.length||(ed.formElement=n,n._mceOldSubmit=n.submit,n.submit=function(){return tinymce.each(tinymce.editors,function(e){e.initialized&&(e.isNotDirty=1,self.getContent(e.id))}),ed.formElement._mceOldSubmit(ed.formElement)},n=null))}),ed.onWfEditorChange=new Dispatcher,ed.onWfEditorChange.add(function(ed,o){tinymce.is(o.content)&&(ed.setContent(o.content,o),ed.onChange.dispatch())}),ed.onSaveContent.add(function(){var bookmark=self.getActiveLine(ed);sessionStorage.setItem(ed.id+"_bookmark",bookmark)}),ed.onRemove.add(function(){var container=DOM.getParent(ed.getElement(),"div.wf-editor-container");if(container){var nodes=tinymce.grep(DOM.select("div",container),function(node){return node!==ed.getElement()&&node!==ed.getContainer()});DOM.remove(nodes),DOM.remove(container,1)}})}),Event.bind(window,"load",function(){function removeEditor(el){var ed=tinymce.EditorManager.get(el.id);ed&&(ed.remove(),ed.destroy(!0),Joomla.editors&&delete Joomla.editors.instances[el.id])}function createEditor(el){var ed=tinymce.EditorManager.get(el.id);ed||(self.createInstance(el),ed=new tinymce.Editor(el.id,s)),ed.render()}_load(),window.jQuery&&(jQuery(document).on("subform-row-add",function(event,row){var elements=DOM.select(".wf-editor",row);each(elements,function(el){createEditor(el)})}),jQuery(document).on("subform-row-remove",function(event,row){var elements=DOM.select(".wf-editor",row);each(elements,function(el){removeEditor(el)})}),jQuery(document).on("subform-row-sort editor-reinit",function(e,row){var elements=DOM.select(".wf-editor",row);each(elements,function(el){removeEditor(el),createEditor(el)})}))}),Event.bind(window,"ready",function(){window.setTimeout(function(){_load()},1e3)})},createInstance:function(el){var self=this,s=this.settings;if("string"==typeof el&&(el=DOM.get(el)),el){var header=DOM.getPrev(el,".wf-editor-header");s.width&&DOM.setStyle(el,"width",s.width),s.height&&DOM.setStyle(el,"height",s.height),self._createToggle(el);var state;s.use_state_cookies!==!1&&(state=tinymce.util.Cookie.get("wf_editor_state_"+el.id)),null!==state&&"undefined"!=typeof state||(state=tinymce.is(s.toggle_state)?s.toggle_state:1),state=parseInt(state);var toggle=tinymce.is(s.toggle)?parseInt(s.toggle):1;!state&&toggle&&(DOM.removeClass(el,"wf-editor"),DOM.addClass(el,"wf-no-editor"),DOM.hide(DOM.select("ul.nav-tabs",header)),DOM.addClass(el.parentNode,"wf-editor-toggle-off"))}},create:function(elements){if("string"==typeof elements){var ed=tinymce.get(elements);ed&&tinymce.remove(ed),elements=[elements]}return this.preinit(elements)},preinit:function(elements){var self=this,s=this.settings;try{"advanced"===s.theme&&(elements=elements||DOM.select(".wf-editor"),each(elements,function(el){DOM.show(el),self.createInstance(el)})),tinymce.init(s)}catch(e){}},_toggleEditor:function(el){var ed=tinymce.get(el.id);if(ed)if(DOM.hasClass(el,"wf-no-editor")){DOM.addClass(el,"wf-editor"),DOM.removeClass(el,"wf-no-editor"),DOM.setStyle(DOM.select("ul.nav-tabs",el.parentNode),"display",""),DOM.removeClass(el.parentNode,"wf-editor-toggle-off"),this.settings.use_state_cookies!==!1&&tinymce.util.Cookie.set("wf_editor_state_"+el.id,1);var activeTab;switch(this.settings.use_state_cookies!==!1&&(activeTab=sessionStorage.getItem("wf-editor-tabs-"+ed.id)),activeTab||activeTab||ed.settings.active_tab||"wf-editor-wysiwyg",DOM.hide(ed.getElement()),activeTab){default:case"wf-editor-wysiwyg":ed.show();break;case"wf-editor-source":ed.plugins.source.toggle();break;case"wf-editor-preview":ed.plugins.preview.toggle()}}else{DOM.addClass(el,"wf-no-editor"),DOM.hide(DOM.select("ul.nav-tabs",el.parentNode)),DOM.addClass(el.parentNode,"wf-editor-toggle-off");var height;this.settings.use_state_cookies!==!1&&(height=sessionStorage.getItem("wf-editor-container-height")),height&&!ed.getParam("fullscreen_enabled")&&DOM.setStyle(ed.getElement(),"height",height),this.settings.use_state_cookies!==!1&&tinymce.util.Cookie.set("wf_editor_state_"+el.id,0),ed.hide(),this.getContent(ed.id),ed.plugins.source&&ed.plugins.source.hide(),ed.plugins.preview&&ed.plugins.preview.hide(),DOM.setStyle(ed.getElement(),"display","")}else DOM.addClass(el.parentNode,"mce-loading"),DOM.removeClass(el,"wf-no-editor"),DOM.removeClass(el.parentNode,"wf-editor-toggle-off"),this.settings.use_state_cookies!==!1&&tinymce.util.Cookie.set("wf_editor_state_"+el.id,1),tinymce.execCommand("mceToggleEditor",!1,el.id),setTimeout(function(){DOM.removeClass(el.parentNode,"mce-loading")},1e3)},_getEditor:function(el){var ed,win=window;return!win.tinymce&&window.parent.tinymce&&(win=window.parent),el&&("string"==typeof el&&(el=document.getElementById(el)),el&&el.id&&(ed=win.tinymce.get(el.id))),ed||(ed=win.tinymce.activeEditor),ed&&!isHidden(ed.id+"_parent")?ed:!(!ed||!document.getElementById(ed.id+"_editor_source")||isHidden(ed.id+"_editor_source"))&&ed.plugins.source},_loadContent:function(ed){var el=ed.getElement();if(isHidden(ed.id+"_parent")&&ed.plugins.source){var code=ed.plugins.source.getContent();null!==code&&(/TEXTAREA|INPUT/i.test(el.nodeName)?el.value=code:el.innerHTML=code,ed.load())}},_createToggle:function(el){var self=this,s=this.settings,toggle=tinymce.is(s.toggle)?s.toggle:1;if(toggle){var btn,header=DOM.getPrev(el,".wf-editor-header");header||(header=this._createHeader(el)),0===DOM.select("button.wf-editor-toggle",header).length&&(btn=DOM.add(header,"button",{class:"wf-editor-toggle btn btn-link",tabindex:"-1"},""+svgToggleIcon+(s.toggle_label||"")),Event.add(btn,"click",function(e){e.preventDefault(),self._toggleEditor(el)}))}},setActiveLine:function(ed,pos){var blocks=[];tinymce.each(ed.schema.getBlockElements(),function(value,name){return!!/\W/.test(name)||void blocks.push(name.toLowerCase())});var nodes=ed.dom.select(blocks.join(",")),node=nodes[pos]||null;if(node){ed.focus();var len=node.childNodes.length;ed.selection.setCursorLocation(node,len),ed.selection.scrollIntoView(node)}},getActiveLine:function(ed){var blocks=[],line=0;tinymce.each(ed.schema.getBlockElements(),function(value,name){return!!/\W/.test(name)||void blocks.push(name.toLowerCase())});var node=ed.selection.getNode(),nodes=ed.dom.select(blocks.join(","));if(!node)return line;1===node.nodeType&&"bookmark"!==node.getAttribute("data-mce-type")||(node=node.parentNode);for(var i=0,len=nodes.length;i<len;i++)if(nodes[i]===node){line=i;break}return line},_toggleTab:function(ed,tab){function getInterfaceHeight(){var h=0,ca=ed.getContentAreaContainer(),p=ca.parentNode;return tinymce.each(p.childNodes,function(n){n!==ca&&(h+=n.offsetHeight)}),h}var self=this,el=(this.settings,ed.getElement());if(DOM.addClass(el.parentNode,"mce-loading"),isHidden(ed.id+"_parent")||DOM.hasClass(el.parentNode,"mce-fullscreen")||(ed.settings.container_height=ed.getContainer().offsetHeight,this.settings.use_state_cookies!==!1&&sessionStorage.setItem("wf-editor-container-height",ed.settings.container_height),ed.settings.container_width=ed.getContainer().offsetWidth,this.settings.use_state_cookies!==!1&&sessionStorage.setItem("wf-editor-container-width",ed.settings.container_width),ed.settings.interface_height=getInterfaceHeight(),this.settings.use_state_cookies!==!1&&sessionStorage.setItem("wf-editor-interface-height",ed.settings.interface_height)),"wf-editor-source"===tab)return ed.hide(),DOM.hide(el),ed.plugins.preview&&ed.plugins.preview.hide(),ed.plugins.source.toggle();if("wf-editor-preview"===tab)return self._loadContent(ed),ed.hide(),DOM.hide(el),ed.plugins.source&&ed.plugins.source.hide(),ed.onToggleTab.dispatch(ed,tab),ed.plugins.preview.toggle();if(self._loadContent(ed),ed.plugins.source){var pos=ed.plugins.source.getCursorPos();pos&&(ed.activeLine=pos),ed.plugins.source.hide()}ed.plugins.preview&&ed.plugins.preview.hide(),DOM.setStyle(ed.id+"_ifr","max-width",DOM.getStyle(el.parentNode,"max-width")),ed.show(),ed.activeLine&&ed===tinymce.activeEditor&&window.setTimeout(function(){self.setActiveLine(ed,ed.activeLine)},100),DOM.removeClass(el.parentNode,"mce-loading")},_textareaResize:function(el){var header=DOM.getPrev(el,".wf-editor-header"),container=header.parentNode;Event.add(el,"mousedown",function(e){var mm=Event.add(el,"mousemove",function(e){container.style.maxWidth=el.offsetWidth+"px"}),mu=Event.add(el,"mouseup",function(e){Event.remove(el,"mousemove",mm),Event.remove(el,"mouseup",mu),container.style.maxWidth=el.offsetWidth+"px"})})},_createHeader:function(element){var container=DOM.create("div",{class:"editor wf-editor-container"},'<div class="wf-editor-header"></div>');return element.parentNode.insertBefore(container,element),DOM.add(container,element),header=container.firstChild,header},_createTabs:function(ed){var self=this,settings=this.settings,plugins=settings.plugins.split(",");if(tinymce.inArray(plugins,"preview")<0&&tinymce.inArray(plugins,"source",plugins)<0)return!1;var header=DOM.getPrev(ed.getElement(),".wf-editor-header");if(header||(header=this._createHeader(ed.getElement())),!DOM.select("ul.wf-editor-tabs",header).length){ed.onToggleTab=new tinymce.util.Dispatcher(ed),window.Joomla&&window.Joomla.WebComponents&&(header=DOM.add(header,"joomla-tab",{orientation:"horizontal",view:"tabs"}));var activeTab,ul=DOM.add(header,"ul",{class:"wf-editor-tabs nav nav-tabs",role:"tablist"});settings.use_state_cookies!==!1&&(activeTab=sessionStorage.getItem("wf-editor-tabs-"+ed.id)),activeTab||(activeTab=ed.settings.active_tab||"wf-editor-wysiwyg");var editorTab=DOM.add(ul,"li",{class:"nav-item",role:"presentation"},'<a href="#wf-editor-wysiwyg" class="nav-link" role="tab">'+ed.getLang("tab.wysiwyg","Editor")+"</a>");if(tinymce.inArray(plugins,"source")!==-1){var sourceTab=DOM.add(ul,"li",{class:"nav-item",role:"presentation"},'<a href="#wf-editor-source" class="nav-link" role="tab">'+ed.getLang("tab.code","Code")+"</a>");"wf-editor-source"===activeTab&&DOM.addClass(sourceTab,"active")}if(tinymce.inArray(plugins,"preview")!==-1){var previewTab=DOM.add(ul,"li",{class:"nav-item",role:"presentation"},'<a href="#wf-editor-preview" class="nav-link" role="tab">'+ed.getLang("tab.preview","Preview")+"</a>");"wf-editor-preview"===activeTab&&DOM.addClass(previewTab,"active")}"wf-editor-wysiwyg"===activeTab&&(DOM.addClass(editorTab,"active"),DOM.addClass(DOM.select("a",editorTab),"active")),Event.add(ul,"click",function(e){e.preventDefault();var n=e.target;if("A"===n.nodeName){var p=n.parentNode;if(!DOM.hasClass(p,"active")){DOM.removeClass(DOM.select("li, a",ul),"active"),DOM.addClass(p,"active"),DOM.addClass(n,"active");var action=n.href.substring(n.href.indexOf("#")+1);settings.use_state_cookies!==!1&&sessionStorage.setItem("wf-editor-tabs-"+ed.id,action),self._toggleTab(ed,action)}}})}},_wrapText:function(el,s){s?el.setAttribute("wrap","soft"):el.removeAttribute("wrap")},setContent:function(id,html){var ed=this._getEditor(id);ed?ed.setContent(html):document.getElementById(id).value=html},getContent:function(id){var ed=this._getEditor(id);return ed?ed.save():document.getElementById(id).value},getSelection:function(id,args){var ed=this._getEditor(id);return ed?ed.getSelection(args||{}):document.getElementById(id).value},insert:function(el,v){var ed=this._getEditor(el);return ed?!!ed&&(ed.execCommand?(ed!==tinymce.activeEditor&&(ed=tinymce.activeEditor),isHidden(ed.getElement())?(ed.lastSelectionBookmark&&ed.selection.moveToBookmark(ed.lastSelectionBookmark),ed.execCommand("mceInsertContent",!1,v),!0):(this.insertIntoTextarea(ed.getElement(),v),!0)):(ed.insertContent(v),!0)):("string"==typeof el&&(el=document.getElementById(el)),el&&!isHidden(el)&&this.insertIntoTextarea(el,v),!0)},insertIntoTextarea:function(el,v){if(document.selection){el.focus();var s=document.selection.createRange();s.text=v}else if(el.selectionStart||"0"==el.selectionStart){var startPos=el.selectionStart,endPos=el.selectionEnd;el.value=el.value.substring(0,startPos)+v+el.value.substring(endPos,el.value.length)}else el.value+=v},convertURL:function(url,elm,save,name){var ed=tinymce.EditorManager.activeEditor,s=tinymce.settings,base=s.document_base_url;if(!url)return url;if(!s.convert_urls||elm&&"LINK"===elm.nodeName||0===url.indexOf("file:"))return url;if(url===base||url===base.substring(0,base.length-1)||"/"===url.charAt(0))return url;if(!s.mixed_urls){if(s.relative_urls)return 0===url.indexOf(base)?ed.documentBaseURI.toRelative(url):url;url=ed.documentBaseURI.toAbsolute(url,s.remove_script_host)}return s.protocol_relative&&(url=url.replace(/(http|https|ftp|ftps):\/\//,"//")),url},indent:function(h){return h=h.replace(/\n+/g,"\n"),tinymce.trim(h)}};window.WFEditor=WFEditor}();