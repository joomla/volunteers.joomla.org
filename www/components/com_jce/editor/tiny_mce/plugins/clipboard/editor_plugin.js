/* jce - 2.6.12 | 2017-04-27 | http://www.joomlacontenteditor.net | Copyright (C) 2006 - 2017 Ryan Demmer. All rights reserved | GNU/GPL Version 2 or later - http://www.gnu.org/licenses/gpl-2.0.html */
!function(){function filter(content,items){return each(items,function(v){content=v.constructor==RegExp?content.replace(v,""):content.replace(v[0],v[1])}),content}function isWordContent(editor,content){return!!editor.settings.clipboard_paste_force_cleanup||(!(!/(content=\"OpenOffice.org[^\"]+\")/i.test(content)&&!ooRe.test(content))||(/<font face="Times New Roman"|class="?Mso|style="[^"]*\bmso-|style='[^'']*\bmso-|w:WordDocument/i.test(content)||/class="OutlineElement/.test(content)||/id="?docs\-internal\-guid\-/.test(content)))}function trimHtml(html){function trimSpaces(all,s1,s2){return s1||s2?" ":" "}function getInnerFragment(html){var startFragment="<!--StartFragment-->",endFragment="<!--EndFragment-->",startPos=html.indexOf(startFragment);if(startPos!==-1){var fragmentHtml=html.substr(startPos+startFragment.length),endPos=fragmentHtml.indexOf(endFragment);if(endPos!==-1&&/^<\/(p|h[1-6]|li)>/i.test(fragmentHtml.substr(endPos+endFragment.length,5)))return fragmentHtml.substr(0,endPos)}return html}return html=filter(getInnerFragment(html),[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/g,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">(\u00a0|&nbsp;)<\/span>( ?)/g,trimSpaces],/<br class="Apple-interchange-newline">/g,/<br>$/i])}function removeExplorerBrElementsAfterBlocks(editor,html){var blockElements=[];each(editor.schema.getBlockElements(),function(block,blockName){blockElements.push(blockName)});var explorerBlocksRegExp=new RegExp("(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*(<\\/?("+blockElements.join("|")+")[^>]*>)(?:<br>&nbsp;[\\s\\r\\n]+|<br>)*","g");return html=filter(html,[[explorerBlocksRegExp,"$1"]]),html=filter(html,[[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]])}function removeWebKitStyles(editor,content){var webKitStyles=editor.settings.paste_webkit_styles;if(editor.settings.clipboard_paste_remove_styles_if_webkit===!1||"all"==webKitStyles)return content;if(webKitStyles&&(webKitStyles=webKitStyles.split(/[, ]/)),webKitStyles){var dom=editor.dom,node=editor.selection.getNode();content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,function(all,before,value,after){var inputStyles=dom.parseStyle(value,"span"),outputStyles={};if("none"===webKitStyles)return before+after;for(var i=0;i<webKitStyles.length;i++){var inputValue=inputStyles[webKitStyles[i]],currentValue=dom.getStyle(node,webKitStyles[i],!0);/color/.test(webKitStyles[i])&&(inputValue=dom.toHex(inputValue),currentValue=dom.toHex(currentValue)),currentValue!=inputValue&&(outputStyles[webKitStyles[i]]=inputValue)}return outputStyles=dom.serializeStyle(outputStyles,"span"),outputStyles?before+' style="'+outputStyles+'"'+after:before+after})}else content=content.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return content=content.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,function(all,before,value,after){return before+' style="'+value+'"'+after})}function processStyles(editor,node){var dom=editor.dom,s=editor.getParam("clipboard_paste_retain_style_properties");s&&tinymce.is(s,"string")&&(styleProps=tinymce.explode(s),each(styleProps,function(style,i){if("border"===style)return styleProps=styleProps.concat(borderStyles),!0})),each(dom.select("*[style]",node),function(n){var ns={},x=0,styles=dom.parseStyle(n.style.cssText);each(styles,function(v,k){tinymce.inArray(styleProps,k)!=-1&&(ns[k]=v,x++)}),dom.setAttrib(n,"style",""),x>0?dom.setStyles(n,ns):"SPAN"!=n.nodeName||n.className||dom.remove(n,!0),tinymce.isWebKit&&n.removeAttribute("data-mce-style")}),each(dom.select("*[align]",node),function(el){var v=dom.getAttrib(el,"align");"left"!==v&&"right"!==v&&"center"!==v||(/(IFRAME|IMG|OBJECT|VIDEO|AUDIO|EMBED)/i.test(el.nodeName)?"center"===v?dom.setStyles(el,{margin:"auto",display:"block"}):dom.setStyle(el,"float",v):dom.setStyle(el,"text-align",v)),el.removeAttribute("align")})}function convertToPixels(v){return 0===parseInt(v,10)?0:(v.indexOf("pt")!==-1&&(v=parseInt(v,10),v=Math.ceil(v/1.33333),v=Math.abs(v)),v)}function isNumericList(text){var patterns,found="";return patterns={"uppper-roman":/^[IVXLMCD]{1,2}\.[ \u00a0]/,"lower-roman":/^[ivxlmcd]{1,2}\.[ \u00a0]/,"upper-alpha":/^[A-Z]{1,2}[\.\)][ \u00a0]/,"lower-alpha":/^[a-z]{1,2}[\.\)][ \u00a0]/,numeric:/^[0-9]+\.[ \u00a0]/,japanese:/^[\u3007\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+\.[ \u00a0]/,chinese:/^[\u58f1\u5f10\u53c2\u56db\u4f0d\u516d\u4e03\u516b\u4e5d\u62fe]+\.[ \u00a0]/},text=text.replace(/^[\u00a0 ]+/,""),each(patterns,function(pattern,type){if(pattern.test(text))return found=type,!1}),found}function isBulletList(text){return/^[\s\u00a0]*[\u2022\u00b7\u00a7\u25CF]\s*/.test(text)}function WordFilter(editor,content){function convertFakeListsToProperLists(node){function getText(node){var txt="";if(3===node.type)return node.value;if(node=node.firstChild)do txt+=getText(node);while(node=node.next);return txt}function trimListStart(node,regExp){if(3===node.type&&regExp.test(node.value))return node.value=node.value.replace(regExp,""),!1;if(node=node.firstChild)do if(!trimListStart(node,regExp))return!1;while(node=node.next);return!0}function removeIgnoredNodes(node){if(node._listIgnore)return void node.remove();if(node=node.firstChild)do removeIgnoredNodes(node);while(node=node.next)}function convertParagraphToLi(paragraphNode,listName,start,type){var level=paragraphNode._listLevel||lastLevel;if(level!=lastLevel&&(level<lastLevel?currentListNode&&(currentListNode=currentListNode.parent.parent):(prevListNode=currentListNode,currentListNode=null)),currentListNode&&currentListNode.name==listName)currentListNode.append(paragraphNode);else{if(prevListNode=prevListNode||currentListNode,currentListNode=new Node(listName,1),type&&/roman|alpha/.test(type)){var style="list-style-type:"+type;currentListNode.attr({style:style,"data-mce-style":style})}start>1&&currentListNode.attr("start",""+start),paragraphNode.wrap(currentListNode)}paragraphNode.name="li",level>lastLevel&&prevListNode&&prevListNode.lastChild.append(currentListNode),lastLevel=level,removeIgnoredNodes(paragraphNode),trimListStart(paragraphNode,/^\u00a0+/),trimListStart(paragraphNode,/^\s*([\u2022\u00b7\u00a7\u25CF]|\w+\.)/),trimListStart(paragraphNode,/^\u00a0+/)}for(var currentListNode,prevListNode,lastLevel=1,elements=[],child=node.firstChild;"undefined"!=typeof child&&null!==child;)if(elements.push(child),child=child.walk(),null!==child)for(;"undefined"!=typeof child&&child.parent!==node;)child=child.walk();for(var i=0;i<elements.length;i++)if(node=elements[i],"p"==node.name&&node.firstChild){var type,nodeText=getText(node);if(isBulletList(nodeText)){convertParagraphToLi(node,"ul");continue}if(type=isNumericList(nodeText)){var matches=/([0-9]+)\./.exec(nodeText),start=1;matches&&(start=parseInt(matches[1],10)),convertParagraphToLi(node,"ol",start,type);continue}if(node._listLevel){convertParagraphToLi(node,"ul",1);continue}currentListNode=null}else prevListNode=currentListNode,currentListNode=null}function filterStyles(node,styleValue){var matches,outputStyles={},styles=editor.dom.parseStyle(styleValue);return each(styles,function(value,name){switch(name){case"mso-list":matches=/\w+ \w+([0-9]+)/i.exec(styleValue),matches&&(node._listLevel=parseInt(matches[1],10)),/Ignore/i.test(value)&&node.firstChild&&(node._listIgnore=!0,node.firstChild._listIgnore=!0);break;case"horiz-align":name="text-align";break;case"vert-align":name="vertical-align";break;case"font-color":case"mso-foreground":case"color":name="color","windowtext"==value&&(value="");break;case"mso-background":case"mso-highlight":name="background";break;case"font-weight":case"font-style":return void("normal"!=value&&(outputStyles[name]=value));case"mso-element":if(/^(comment|comment-list)$/i.test(value))return void node.remove()}return 0===name.indexOf("mso-comment")?void node.remove():void(0!==name.indexOf("mso-")&&(tinymce.inArray(pixelStyles,name)!==-1&&(value=convertToPixels(value)),validStyles&&validStyles[name]&&(outputStyles[name]=value)))}),/(bold)/i.test(outputStyles["font-weight"])&&(delete outputStyles["font-weight"],node.wrap(new Node("b",1))),/(italic)/i.test(outputStyles["font-style"])&&(delete outputStyles["font-style"],node.wrap(new Node("i",1))),outputStyles=editor.dom.serializeStyle(outputStyles,node.name),outputStyles?outputStyles:null}var retainStyleProperties,settings=editor.settings,validStyles={};if(content=content.replace(/<meta([^>]+)>/,""),content=content.replace(/<!--([\s\S]*?)-->/gi,""),content=content.replace(/<style([^>]*)>([\w\W]*?)<\/style>/gi,""),content=content.replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|meta|link|\w:\w+)(?=[\s\/>]))[^>]*>/gi,""),content=content.replace(/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""),content=filter(content,[[/[\s\S]+?<meta[^>]*>/,""],[/<!--[\s\S]+?-->/gi,""],[/<style[^>]*>[\s\S]+?<\/style>/gi,""]]),content=content.replace(ooRe,"","g"),content=content.replace(/<b[^>]+id="?docs-internal-[^>]*>/gi,""),content=content.replace(/<br class="?Apple-interchange-newline"?>/gi,""),retainStyleProperties=settings.clipboard_paste_retain_style_properties,retainStyleProperties&&each(retainStyleProperties.split(/[, ]/),function(style){return"border"===style?(each(borderStyles,function(name){validStyles[name]={}}),!0):void(validStyles[style]={})}),settings.paste_enable_default_filters!==!1){content=filter(content,[/<!--[\s\S]+?-->/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi," "],[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(str,spaces){return spaces.length>0?spaces.replace(/./," ").slice(Math.floor(spaces.length/2)).split("").join(" "):""}]]),content=content.replace(/<table([^>]+)>/,function($1,$2){return"html4"!==settings.schema&&($2=$2.replace(/(border|cell(padding|spacing))="([^"]+)"/gi,"")),"<table"+$2+">"}),settings.forced_root_block&&(content=content.replace(/<br><br>/gi,""));var validElements=settings.paste_word_valid_elements;validElements||(validElements="-strong/b,-em/i,-u,-span,-p,-ol,-ul,-li,-h1,-h2,-h3,-h4,-h5,-h6,-p/div,-a[href|name],img[src|alt|width|height],sub,sup,strike,br,del,table[width],tr,td[colspan|rowspan|width],th[colspan|rowspan|width],thead,tfoot,tbody");var schema=new Schema({valid_elements:validElements,valid_children:"-li[p]"});each(schema.elements,function(rule){rule.attributes.class||(rule.attributes.class={},rule.attributesOrder.push("class")),rule.attributes.style||(rule.attributes.style={},rule.attributesOrder.push("style"))});var domParser=new DomParser({},schema);domParser.addAttributeFilter("style",function(nodes){for(var node,i=nodes.length;i--;)node=nodes[i],node.attr("style",filterStyles(node,node.attr("style"))),"span"==node.name&&node.parent&&!node.attributes.length&&node.unwrap()}),domParser.addAttributeFilter("class",function(nodes){for(var node,className,i=nodes.length;i--;)node=nodes[i],className=node.attr("class"),/^(MsoCommentReference|MsoCommentText|msoDel)$/i.test(className)&&node.remove(),node.attr("class",null)}),domParser.addNodeFilter("del",function(nodes){for(var i=nodes.length;i--;)nodes[i].remove()});var footnotes=editor.getParam("clipboard_paste_process_footnotes","convert");domParser.addNodeFilter("a",function(nodes){for(var node,href,name,i=nodes.length;i--;)if(node=nodes[i],href=node.attr("href"),name=node.attr("name"),href&&href.indexOf("#_msocom_")!=-1)node.remove();else if(href&&!name&&(href=editor.convertURL(href)),href&&0===href.indexOf("file://")&&(href=href.split("#")[1],href&&(href="#"+href)),href||name){if(name&&!/^_?(?:toc|edn|ftn)/i.test(name)){node.unwrap();continue}if(name&&"remove"===footnotes){node.remove();continue}if(name&&"unlink"===footnotes){node.unwrap();continue}node.attr({href:href,name:null}),"html4"===settings.schema?node.attr("name",name):node.attr("id",name)}else node.unwrap()});var rootNode=domParser.parse(content);return settings.paste_convert_word_fake_lists!==!1&&convertFakeListsToProperLists(rootNode),content=new Serializer({validate:settings.validate},schema).serialize(rootNode)}}function convertURLs(ed,content){var ex="([-!#$%&'*+\\./0-9=?A-Z^_`a-z{|}~]+@[-!#$%&'*+\\/0-9=?A-Z^_`a-z{|}~]+.[-!#$%&'*+\\./0-9=?A-Z^_`a-z{|}~]+)",ux="((news|telnet|nttp|file|http|ftp|https)://[-!#$%&'*+\\/0-9=?A-Z^_`a-z{|}~;]+.[-!#$%&'*+\\./0-9=?A-Z^_`a-z{|}~;]+)";return ed.getParam("autolink_url",!0)&&(content=content.replace(new RegExp("(=[\"']|>)?"+ux,"g"),function(a,b,c){return b?a:'<a href="'+c+'">'+c+"</a>"})),ed.getParam("autolink_email",!0)&&(content=content.replace(new RegExp("(=[\"']mailto:|>)?"+ex,"g"),function(a,b,c){return b?a:'<a href="mailto:'+c+'">'+c+"</a>"})),content}var each=tinymce.each,VK=tinymce.VK,Schema=(tinymce.dom.Event,tinymce.html.Schema),DomParser=tinymce.html.DomParser,Serializer=tinymce.html.Serializer,Node=tinymce.html.Node,styleProps=["background","background-attachment","background-color","background-image","background-position","background-repeat","border","border-bottom","border-bottom-color","border-bottom-style","border-bottom-width","border-color","border-left","border-left-color","border-left-style","border-left-width","border-right","border-right-color","border-right-style","border-right-width","border-style","border-top","border-top-color","border-top-style","border-top-width","border-width","outline","outline-color","outline-style","outline-width","height","max-height","max-width","min-height","min-width","width","font","font-family","font-size","font-style","font-variant","font-weight","content","counter-increment","counter-reset","quotes","list-style","list-style-image","list-style-position","list-style-type","margin","margin-bottom","margin-left","margin-right","margin-top","padding","padding-bottom","padding-left","padding-right","padding-top","bottom","clear","clip","cursor","display","float","left","overflow","position","right","top","visibility","z-index","orphans","page-break-after","page-break-before","page-break-inside","widows","border-collapse","border-spacing","caption-side","empty-cells","table-layout","color","direction","letter-spacing","line-height","text-align","text-decoration","text-indent","text-shadow","text-transform","unicode-bidi","vertical-align","white-space","word-spacing"],pixelStyles=["width","height","min-width","max-width","min-height","max-height","margin-top","margin-right","margin-bottom","margin-left","padding-top","padding-right","padding-bottom","padding-left","border-top-width","border-right-width","border-bottom-width","border-left-width"],borderStyles=["border","border-width","border-style","border-color","border-top","border-right","border-bottom","border-left","border-top-width","border-right-width","border-bottom-width","border-left-width","border-top-color","border-right-color","border-bottom-color","border-left-color","border-top-style","border-right-style","border-bottom-style","border-left-style"],ooRe=/(Version:[\d\.]+)\s*?((Start|End)(HTML|Fragment):[\d]+\s*?){4}/;tinymce.create("tinymce.plugins.ClipboardPlugin",{init:function(ed,url){function process(o){var rng,dom=ed.dom;switch(ed.setProgressState(1),o.content=trimHtml(o.content),self.command){case"mcePaste":self.pasteHtml||(self.command="mcePasteText");break;case"mcePasteText":self.pasteText||(self.command="mcePaste");break;case"mcePasteWord":self.pasteWord&&self.pasteHtml||(self.command="mcePasteText");break;default:self.command="mcePaste",!self.pasteHtml&&self.pasteText&&(self.command="mcePasteText")}self.plainText="mcePasteText"==self.command,self.onPreProcess.dispatch(self,o),o.node=dom.create("div",0,o.content),tinymce.isGecko&&(rng=ed.selection.getRng(!0),rng.startContainer==rng.endContainer&&3==rng.startContainer.nodeType&&1===o.node.childNodes.length&&/^(p|h[1-6]|pre)$/i.test(o.node.firstChild.nodeName)&&o.content.indexOf("__MCE_ITEM__")===-1&&dom.remove(o.node.firstChild,!0)),self.onPostProcess.dispatch(self,o),o.content=ed.serializer.serialize(o.node,{getInner:1,forced_root_block:""}),self.plainText?self._insertPlainText(o.content):self._insert(o.content),self.onAfterPaste.dispatch(self),ed.setProgressState(0),self.command="mcePaste"}function grabContent(e){function block(e){e.preventDefault()}var n,or,rng,oldRng,posY,textContent,sel=ed.selection,dom=ed.dom,doc=ed.getDoc(),body=ed.getBody();if((e.clipboardData||doc.dataTransfer)&&(textContent=(e.clipboardData||doc.dataTransfer).getData("Text"),ed.pasteAsPlainText))return e.preventDefault(),void process({content:textContent.replace(/\r?\n/g,"<br />")});if(!dom.get("_mcePaste"))if(n=dom.add(body,"div",{id:"_mcePaste",class:"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff"),posY=body!=ed.getDoc().body?dom.getPos(ed.selection.getStart(),body).y:body.scrollTop+dom.getViewPort(ed.getWin()).y,dom.setStyles(n,{position:"absolute",left:tinymce.isIE||tinymce.isGecko?-40:0,top:posY-25,width:10,height:10,overflow:"hidden",opacity:0}),tinymce.isIE&&!tinymce.isIE11){if(oldRng=sel.getRng(),rng=dom.doc.body.createTextRange(),rng.moveToElementText(n),rng.execCommand("Paste"),dom.remove(n),"\ufeff\ufeff"===n.innerHTML)return void e.preventDefault();sel.setRng(oldRng),sel.setContent(""),setTimeout(function(){process({content:ed.pasteAsPlainText?n.textContent.replace(/\r?\n/g,"<br />"):n.innerHTML})},0),tinymce.dom.Event.cancel(e)}else dom.bind(doc,"mousedown",block),dom.bind(doc,"keydown",block),or=ed.selection.getRng(),n=n.firstChild,rng=doc.createRange(),rng.setStart(n,0),rng.setEnd(n,2),sel.setRng(rng),window.setTimeout(function(){var nl,h="";dom.select("div.mcePaste > div.mcePaste").length?h="<p>"+dom.encode(textContent).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>":(nl=dom.select("div.mcePaste"),each(nl,function(n){var child=n.firstChild;child&&"DIV"==child.nodeName&&child.style.marginTop&&child.style.backgroundColor&&dom.remove(child,1),each(dom.select("span.Apple-style-span",n),function(n){dom.remove(n,1)}),each(dom.select("br[data-mce-bogus]",n),function(n){dom.remove(n)}),"mcePaste"!=n.parentNode.className&&(h+=n.innerHTML)})),each(dom.select("div.mcePaste"),function(n){dom.remove(n)}),or&&sel.setRng(or),process({content:h}),dom.unbind(ed.getDoc(),"mousedown",block),dom.unbind(ed.getDoc(),"keydown",block)},0)}var self=this;self.editor=ed,self.url=url,this.canPaste=!1,self.onPreProcess=new tinymce.util.Dispatcher(this),self.onPostProcess=new tinymce.util.Dispatcher(this),self.onAfterPaste=new tinymce.util.Dispatcher(this),self.onPreProcess.add(self._preProcess),self.onPostProcess.add(self._postProcess),self.onPreProcess.add(function(pl,o){ed.execCallback("paste_preprocess",pl,o)}),self.onPostProcess.add(function(pl,o){ed.execCallback("paste_postprocess",pl,o)}),ed.onKeyDown.addToTop(function(ed,e){return!(VK.metaKeyPressed&&86==e.keyCode||e.shiftKey&&45==e.keyCode)&&(!ed.getParam("clipboard_allow_cut",1)&&VK.metaKeyPressed&&88==e.keyCode?(e.preventDefault(),!1):!ed.getParam("clipboard_allow_copy",1)&&VK.metaKeyPressed&&67==e.keyCode?(e.preventDefault(),!1):void 0)}),self.pasteText=ed.getParam("clipboard_paste_text",1),self.pasteHtml=ed.getParam("clipboard_paste_html",1),ed.addCommand("mceInsertClipboardContent",function(u,o){process(o)}),ed.onInit.add(function(){ed.plugins.contextmenu&&ed.plugins.contextmenu.onContextMenu.add(function(th,m,e){var c=ed.selection.isCollapsed();ed.getParam("clipboard_cut",1)&&m.add({title:"advanced.cut_desc",icon:"cut",cmd:"Cut"}).setDisabled(c),ed.getParam("clipboard_copy",1)&&m.add({title:"advanced.copy_desc",icon:"copy",cmd:"Copy"}).setDisabled(c),self.pasteHtml&&m.add({title:"clipboard.paste_desc",icon:"paste",cmd:"mcePaste"}),self.pasteText&&m.add({title:"clipboard.paste_text_desc",icon:"pastetext",cmd:"mcePasteText"})})}),tinymce.isOpera?ed.onKeyDown.addToTop(function(ed,e){((tinymce.isMac?e.metaKey:e.ctrlKey)&&86==e.keyCode||e.shiftKey&&45==e.keyCode)&&grabContent(e)}):ed.onPaste.addToTop(function(ed,e){return grabContent(e)}),ed.getParam("clipboard_paste_block_drop")&&ed.onInit.add(function(){ed.dom.bind(ed.getBody(),["dragend","dragover","draggesture","dragdrop","drop","drag"],function(e){return e.preventDefault(),e.stopPropagation(),!1})}),each(["Cut","Copy"],function(command){ed.addCommand(command,function(){var failed,doc=ed.getDoc();try{doc.execCommand(command,!1,null)}catch(ex){failed=!0}var msg=ed.getLang("clipboard_msg","");msg=msg.replace(/\%s/g,tinymce.isMac?"CMD":"CTRL"),!failed&&doc.queryCommandSupported(command)||(tinymce.isGecko?ed.windowManager.confirm(msg,function(state){state&&open("http://www.mozilla.org/editor/midasdemo/securityprefs.html","_blank")}):ed.windowManager.alert(ed.getLang("clipboard_no_support")))})}),each(["mcePasteText","mcePaste"],function(cmd){ed.addCommand(cmd,function(){var doc=ed.getDoc();if(self.command=cmd,ed.getParam("clipboard_paste_use_dialog")||tinymce.isIE&&!doc.queryCommandSupported("Paste"))return self._openWin(cmd);try{doc.execCommand("Paste",!1,null)}catch(e){self.canPaste=!1}return self.canPaste===!1?self._openWin(cmd):void 0})}),self.pasteHtml&&ed.addButton("paste",{title:"clipboard.paste_desc",cmd:"mcePaste",ui:!0}),self.pasteText&&ed.addButton("pastetext",{title:"clipboard.paste_text_desc",cmd:"mcePasteText",ui:!0}),ed.getParam("clipboard_cut",1)&&ed.addButton("cut",{title:"advanced.cut_desc",cmd:"Cut",icon:"cut"}),ed.getParam("clipboard_copy",1)&&ed.addButton("copy",{title:"advanced.copy_desc",cmd:"Copy",icon:"copy"})},getInfo:function(){return{longname:"Paste text/word",author:"Moxiecode Systems AB / Ryan demmer",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/paste",version:"@@version@@"}},_openWin:function(cmd){var ed=this.editor;ed.windowManager.open({file:ed.getParam("site_url")+"index.php?option=com_jce&view=editor&plugin=clipboard&cmd="+cmd,width:parseInt(ed.getParam("clipboard_paste_dialog_width","450")),height:parseInt(ed.getParam("clipboard_paste_dialog_height","400")),inline:1,popup_css:!1},{cmd:cmd})},_preProcess:function(pl,o){var rb,ed=pl.editor,h=o.content;if(0!=ed.settings.paste_enable_default_filters){if(tinymce.isIE&&(h=removeExplorerBrElementsAfterBlocks(ed,h)),h=h.replace(/^\s*(&nbsp;)+/g,""),h=h.replace(/(&nbsp;|<br[^>]*>)+\s*$/g,""),this.plainText)return h;if(o.wordContent=isWordContent(ed,h),o.wordContent&&(h=WordFilter(ed,h)),tinymce.isWebKit&&!o.wordContent&&(h=removeWebKitStyles(ed,h)),ed.getParam("clipboard_paste_remove_attributes")){var attribs=ed.getParam("clipboard_paste_remove_attributes").split(",");h=h.replace(new RegExp(" ("+attribs.join("|")+')="([^"]+)"',"gi"),"")}if(rb=ed.getParam("forced_root_block")){var blocks="";h.indexOf("<br><br>")!=-1&&(tinymce.each(h.split("<br><br>"),function(block){blocks+="<"+rb+">"+block+"</"+rb+">"}),h=blocks)}ed.getParam("clipboard_paste_remove_spans")&&(h=h.replace(/<\/?(u|strike)[^>]*>/gi,""),ed.settings.convert_fonts_to_spans&&(h=h.replace(/<\/?(font)[^>]*>/gi,"")),h=h.replace(/<\/?(span)[^>]*>/gi,"")),ed.getParam("forced_root_block")||(ed.getParam("clipboard_paste_remove_empty_paragraphs",!0)&&(h=h.replace(/<p([^>]*)>(\s|&nbsp;|\u00a0)*<\/p>/gi,"")),h=h.replace(/<\/(p|div)>/gi,"<br /><br />").replace(/<(p|div)([^>]*)>/g,"").replace(/(<br \/>){2}$/g,"")),ed.getParam("clipboard_paste_convert_urls",!0)&&(h=convertURLs(ed,h)),ed.settings.verify_html===!1&&(h=h.replace(/<b\b([^>]*)>/gi,"<strong$1>"),h=h.replace(/<\/b>/gi,"</strong>")),o.content=h}},_insertPlainText:function(h){var rb,ed=this.editor,dom=ed.dom;"string"==typeof h&&h.length>0&&(h=WordFilter(ed,h),h=/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(h)?h.replace(/[\n\r]+/g,""):h.replace(/\r+/g,""),h=h.replace(/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"),h=h.replace(/<br[^>]*>|<\/tr>/gi,"\n"),h=h.replace(/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"),h=h.replace(/<[a-z!\/?][^>]*>/gi,""),h=h.replace(/&nbsp;/gi," "),h=dom.decode(tinymce.html.Entities.encodeRaw(h)),h=h.replace(/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"),h=h.replace(/\n{3,}/g,"\n\n"),h=h.replace(/^\s+|\s+$/g,""),h=h.replace(/\u2026/g,"..."),h=h.replace(/[\x93\x94]/g,'"'),h=h.replace(/[\x60\x91\x92]/g,"'"),(rb=ed.getParam("forced_root_block"))&&(h=h.replace(/^\s+|\s+$/g,""),h=h.replace(/\n\n/g,"</"+rb+"><"+rb+">")),h=h.replace(/\n+?/g,"<br />"),ed.getParam("clipboard_paste_remove_empty_paragraphs",!0)&&(h=h.replace(/<p>(\s|&nbsp;|\u00a0)?<\/p>/gi,""))),this._insert(h)},_postProcess:function(pl,o){var ed=this.editor,dom=ed.dom;if(0!=ed.settings.paste_enable_default_filters&&!this.plainText){each(dom.select("span.Apple-style-span",o.node),function(n){dom.remove(n,1)}),ed.getParam("clipboard_paste_remove_styles")?each(dom.select("*[style]",o.node),function(el){el.removeAttribute("style"),el.removeAttribute("data-mce-style")}):processStyles(ed,o.node),o.wordContent&&each(dom.select("table[style], td[style], th[style]",o.node),function(n){var styles={};each(borderStyles,function(name){if(/-(top|right|bottom|left)-/.test(name)){var value=dom.getStyle(n,name);"currentcolor"===value&&(value=""),value&&/^\d[a-z]?/.test(value)&&(value=convertToPixels(value),value&&(value+="px")),styles[name]=value}}),each(styles,function(v,k){if(k.indexOf("-width")!==-1&&""===v){var s=k.replace(/-width/,"");delete styles[s+"-style"],delete styles[s+"-color"],delete styles[k]}}),dom.setStyle(n,"border",""),dom.setAttrib(n,"style",dom.serializeStyle(dom.parseStyle(dom.serializeStyle(styles,n.nodeName))),n.nodeName)});var imgRe=/(file:|data:image)\//i,uploader=ed.plugins.upload,canUpload=uploader&&uploader.plugins.length;if(each(dom.select("img",o.node),function(el){var s=dom.getAttrib(el,"src");!s||imgRe.test(s)?ed.getParam("clipboard_paste_upload_images",!0)&&canUpload?ed.dom.setAttrib(el,"data-mce-upload-marker","1"):dom.remove(el):dom.setAttrib(el,"src",ed.convertURL(s))}),tinymce.isIE&&each(dom.select("a",o.node),function(el){each(dom.select("font,u"),function(n){dom.remove(n,1)})}),ed.getParam("clipboard_paste_remove_tags")&&dom.remove(dom.select(ed.getParam("clipboard_paste_remove_tags"),o.node),1),ed.getParam("clipboard_paste_keep_tags")){var tags=ed.getParam("clipboard_paste_keep_tags");dom.remove(dom.select("*:not("+tags+")",o.node),1)}ed.getParam("clipboard_paste_remove_spans")?dom.remove(dom.select("span",o.node),1):(ed.dom.remove(dom.select("span:empty",o.node)),each(dom.select("span",o.node),function(n){n.childNodes&&0!==n.childNodes.length||dom.remove(n),0===dom.getAttribs(n).length&&dom.remove(n,1)})),ed.getParam("clipboard_paste_remove_empty_paragraphs",!0)&&(dom.remove(dom.select("p:empty",o.node)),each(dom.select("p",o.node),function(n){var h=n.innerHTML;n.childNodes&&0!==n.childNodes.length&&!/^(\s|&nbsp;|\u00a0)?$/.test(h)||dom.remove(n)}))}},_insert:function(h,skip_undo){var ed=this.editor;if(ed.getParam("clipboard_paste_remove_empty_paragraphs",!0)&&(h=h.replace(/<p([^>]+)>(&nbsp;|\u00a0)?<\/p>/g,"")),ed.getParam("clipboard_paste_filter")){var re,rules=ed.getParam("clipboard_paste_filter").split(";");each(rules,function(s){re=/^\/.*\/(g|i|m)*$/.test(s)?new Function("return "+s)():new RegExp(s),h=h.replace(re,"")})}ed.execCommand("mceInsertContent",!1,h,{skip_undo:skip_undo})}}),tinymce.PluginManager.add("clipboard",tinymce.plugins.ClipboardPlugin)}();