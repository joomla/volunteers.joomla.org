/*
 Copyright (c)2006-2023 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license   GNU General Public License version 3, or later
*/
if("undefined"==typeof akeeba)var akeeba={};"undefined"==typeof akeeba.Fsfilters&&(akeeba.Fsfilters={currentRoot:null});akeeba.Fsfilters.activeRootChanged=function(){var b=document.getElementById("active_root"),c={};c.root=b.options[b.selectedIndex].value;c.crumbs=[];c.node="";akeeba.Fsfilters.load(c)};akeeba.Fsfilters.activeTabRootChanged=function(){var b=document.getElementById("active_root");akeeba.Fsfilters.loadTab(b.options[b.selectedIndex].value)};
akeeba.Fsfilters.load=function(b){b.verb="list";b=JSON.stringify(b);var c={};c.action=b;akeeba.System.doAjax(c,function(f){akeeba.Fsfilters.render(f)},null,!1,15E3)};
akeeba.Fsfilters.toggle=function(b,c,f,g){null==g&&(g=!0);if(null!=c){if(1==akeeba.System.data.get(c,"loading",!1))return;akeeba.System.data.set(c,"loading",!0);var d=c;g&&(d=c.querySelector("span"));akeeba.System.data.get(c,"iconClass","")||akeeba.System.data.set(c,"iconClass",d.className);d.className="ak-toggle-button ak-toggle-button-spinning akion-android-star-outline";var e=setInterval(function(){"undefined"===typeof d.className?clearInterval(e):-1!=d.className.indexOf("akion-android-star-outline")?
(akeeba.System.removeClass(d,"akion-android-star-outline"),akeeba.System.addClass(d,"akion-android-star")):-1!=d.className.indexOf("akion-android-star")&&(akeeba.System.addClass(d,"akion-android-star-outline"),akeeba.System.removeClass(d,"akion-android-star"))},250);akeeba.System.data.set(c,"akeebatimer",e)}var a={action:JSON.stringify(b)};akeeba.System.doAjax(a,function(k){if(null!=c){var h=akeeba.System.data.get(c,"akeebatimer");clearInterval(h);if(h=akeeba.System.data.get(c,"iconClass"))d.className=
h;akeeba.System.data.set(c,"iconClass",null);akeeba.System.data.set(c,"loading",null)}1==k.success?(null!=c&&g&&(1==k.newstate?(akeeba.System.removeClass(c,"akeeba-btn--grey"),akeeba.System.addClass(c,"akeeba-btn--orange")):(akeeba.System.removeClass(c,"akeeba-btn--orange"),akeeba.System.addClass(c,"akeeba-btn--grey"))),null!=f&&f(k,c)):(null!=f&&f(k,c),akeeba.System.modalErrorHandler(akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_LABEL_UIERRORFILTER").replace("%s",b.node)))},function(k){if(null!=c){var h=
akeeba.System.data.get(c,"akeebatimer");clearInterval(h);d.className=akeeba.System.data.get(c,"iconClass");akeeba.System.data.set(c,"iconClass");akeeba.System.data.set(c,"loading")}akeeba.System.params.errorCallback(k)},!0,15E3)};
akeeba.Fsfilters.render=function(b){akeeba.Fsfilters.currentRoot=b.root;crumbs=akeeba.Fsfilters.renderCrumbs(b);var c=document.getElementById("folders");c.innerHTML="";0<b.crumbs.length&&akeeba.Fsfilters.renderParentFolderElement();if(0<Object.keys(b.folders).length){var f=["directories_all","skipdirs_all","skipfiles_all"],g=document.createElement("div");g.className="folder-header folder-container";for(var d=0;d<f.length;d++){var e=f[d],a=document.createElement("span");a.className="folder-icon-container akeeba-btn--mini akeeba-btn--grey";
a.setAttribute("title",akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_"+e.toUpperCase()));var k="";switch(e){case "directories_all":k="akion-close-circled";a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-close-circled"></span>');break;case "skipdirs_all":k="akion-folder";a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-folder"></span>');break;case "skipfiles_all":k="akion-document",a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-document"></span>')}akeeba.System.addEventListener(a,
"click",function(m,l){return function(){if(-1!=m.className.indexOf("akeeba-btn--orange")){akeeba.System.removeClass(m,"akeeba-btn--orange");akeeba.System.addClass(m,"akeeba-btn--grey");var n=!1}else akeeba.System.removeClass(m,"akeeba-btn--grey"),akeeba.System.addClass(m,"akeeba-btn--orange"),n=!0;for(var p=1;p<c.children.length;p++){var q=c.children[p].querySelector("span."+l),r=-1!=q.parentNode.className.indexOf("akeeba-btn--orange");!n&&!r||n&&r||akeeba.System.triggerEvent(q,"click")}}}(a,k));
g.appendChild(a)}a=document.createElement("span");a.className="folder-name";a.innerHTML='<span class="pull-left akion-arrow-down-a"></span>'+akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_APPLYTOALLDIRS");g.appendChild(a);c.appendChild(g)}for(var h in b.folders){if(!b.folders.hasOwnProperty(h))return;g=b.folders[h];uielement=document.createElement("div");uielement.className="folder-container";f=["directories","skipdirs","skipfiles"];for(d=0;d<f.length;d++){e=f[d];a=document.createElement("span");
a.className="akeeba-btn--mini akeeba-btn--grey folder-icon-container";a.setAttribute("title",akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_"+e.toUpperCase()));switch(e){case "directories":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-close-circled"></span>');break;case "skipdirs":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-folder"></span>');break;case "skipfiles":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-document"></span>')}a.setAttribute("data-akeeba-tooltip-position",
"right");switch(g[e]){case 2:akeeba.System.removeClass(a,"akeeba-btn--grey");akeeba.System.addClass(a,"akeeba-btn--red");break;case 1:akeeba.System.removeClass(a,"akeeba-btn--grey"),akeeba.System.addClass(a,"akeeba-btn--orange");case 0:akeeba.System.addEventListener(a,"click",function(m,l,n){return function(){akeeba.Fsfilters.toggle({root:b.root,crumbs,node:m,filter:l,verb:"toggle"},n)}}(h,e,a))}uielement.appendChild(a)}a=document.createElement("span");a.textContent=h;g.link&&(a.innerHTML='<span class="akion-link" aria-hidden="true"></span> '+
a.innerHTML);a.className="folder-name";akeeba.System.addEventListener(a,"click",function(m){return function(){var l=document.createElement("img");l.setAttribute("src",akeeba.System.getOptions("akeeba.Fsfilters.loadingGif",""));l.setAttribute("width",16);l.setAttribute("height",11);l.setAttribute("border",0);l.setAttribute("alt","Loading...");l.style.marginTop="3px";l.style.marginLeft="5px";this.appendChild(l);akeeba.Fsfilters.load({root:b.root,crumbs,node:m})}}(h));uielement.appendChild(a);c.appendChild(uielement)}h=
document.getElementById("files");h.innerHTML="";0<Object.keys(b.files).length&&(e=document.createElement("div"),e.className="file-header file-container",a=document.createElement("span"),a.className="file-icon-container akeeba-btn--mini akeeba-btn--grey",a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-close-circled"></span>'),a.setAttribute("title",akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_FILES_ALL")),akeeba.System.addEventListener(a,"click",function(m){return function(){if(-1!=
this.className.indexOf("akeeba-btn--orange")){akeeba.System.removeClass(this,"akeeba-btn--orange");akeeba.System.addClass(this,"akeeba-btn--grey");var l=!1}else akeeba.System.removeClass(this,"akeeba-btn--grey"),akeeba.System.addClass(this,"akeeba-btn--orange"),l=!0;for(var n=document.getElementById("files"),p=1;p<n.children.length;p++){var q=n.children[p].querySelector("span.akion-close-circled"),r=-1!=q.parentNode.className.indexOf("akeeba-btn--orange");!l&&!r||l&&r||akeeba.System.triggerEvent(q,
"click")}}}(a)),e.appendChild(a),a=document.createElement("span"),a.className="file-name",a.innerHTML='<span class="pull-left akion-arrow-down-a"></span>'+akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_APPLYTOALLFILES"),e.appendChild(a),h.appendChild(e));for(fileName in b.files)if(b.files.hasOwnProperty(fileName)){g=b.files[fileName];uielement=document.createElement("div");uielement.className="file-container";f=["files"];for(d=0;d<f.length;d++){e=f[d];a=document.createElement("span");a.className=
"file-icon-container akeeba-btn--mini akeeba-btn--grey";switch(e){case "files":a.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-close-circled"></span>')}a.setAttribute("title",akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_"+e.toUpperCase()));switch(g[e]){case 2:akeeba.System.removeClass(a,"akeeba-btn--grey");akeeba.System.addClass(a,"akeeba-btn--red");break;case 1:akeeba.System.removeClass(a,"akeeba-btn--grey"),akeeba.System.addClass(a,"akeeba-btn--orange");case 0:akeeba.System.addEventListener(a,
"click",function(m,l,n){return function(){akeeba.Fsfilters.toggle({root:b.root,crumbs,node:m,filter:l,verb:"toggle"},n)}}(fileName,e,a))}uielement.appendChild(a)}a=document.createElement("span");a.className="file-name";a.textContent=fileName;g.link&&(a.innerHTML='<span class="akion-link" aria-hidden="true"></span> '+a.innerHTML);uielement.appendChild(a);a=document.createElement("span");a.className="file-size";a.textContent=g.size;uielement.appendChild(a);h.appendChild(uielement)}};
akeeba.Fsfilters.nuke=function(){var b={action:JSON.stringify({root:akeeba.Fsfilters.currentRoot,verb:"reset"})};akeeba.System.doAjax(b,function(c){akeeba.Fsfilters.render(c)},null,!1,15E3)};akeeba.Fsfilters.loadTab=function(b){b={action:JSON.stringify({verb:"tab",root:b})};akeeba.System.doAjax(b,function(c){akeeba.Fsfilters.renderTab(c)},null,!1,15E3)};
akeeba.Fsfilters.addRow=function(b,c){var f=akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_TYPE_"+b.type.toUpperCase());null==f&&(f=b.type);var g=document.createElement("tr");g.className="ak_filter_row";var d=document.createElement("td");g.appendChild(d);d.className="ak_filter_type";d.insertAdjacentHTML("beforeend",f);f=document.createElement("td");g.appendChild(f);f.className="ak_filter_item";d=document.createElement("span");f.appendChild(d);d.className="ak_filter_tab_icon_container akeeba-btn--mini akeeba-btn--red deletecontainer";
akeeba.System.addEventListener(d,"click",function(){if(""==b.node){var e=this.parentNode.parentNode;e.parentNode.removeChild(e)}else e=document.getElementById("active_root"),akeeba.Fsfilters.toggle({root:e.options[e.selectedIndex].value,crumbs:[],node:b.node,filter:b.type,verb:"toggle"},this,function(a,k){a.success&&(a=k.parentNode.parentNode,a.parentNode.removeChild(a))})});d.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-trash-a deletebutton"></span>');d=document.createElement("span");
f.appendChild(d);d.className="ak_filter_tab_icon_container akeeba-btn--mini akeeba-btn--teal editcontainer";akeeba.System.addEventListener(d,"click",function(){if(null==this.parentNode.querySelector("input")){this.parentNode.querySelector("span.ak_filter_name").style.display="none";var e=document.createElement("input");e.setAttribute("type","text");e.setAttribute("size",60);e.value=this.parentNode.querySelector("span.ak_filter_name").textContent;this.parentNode.appendChild(e);akeeba.System.addEventListener(e,
"blur",function(){var a=this.value,k=this;if(""==a)akeeba.System.triggerEvent(k.parentNode.querySelector("span.deletebutton"),"click");else{var h=document.getElementById("active_root");h={root:h.options[h.selectedIndex].value,crumbs:[],old_node:b.node,new_node:a,filter:b.type,verb:"swap"};var m=k.parentNode.querySelector("span.editcontainer");akeeba.Fsfilters.toggle(h,m,function(l,n){l=k.parentNode.querySelector("span.ak_filter_name");l.style.display="inline-block";l.textContent=a;k.parentNode.removeChild(k);
b.node=a})}});e.focus()}});d.insertAdjacentHTML("beforeend",'<span class="ak-toggle-button akion-edit editbutton"></span>');d=document.createElement("span");d.className="ak_filter_name";d.textContent=b.node;f.appendChild(d);c.appendChild(g)};
akeeba.Fsfilters.addNew=function(b){akeeba.Fsfilters.addRow({type:b,node:""},document.getElementById("ak_list_table").children[1]);b=document.getElementById("ak_list_table").children[1].children;akeeba.System.triggerEvent(b[b.length-1].querySelector("span.editcontainer"),"click")};akeeba.Fsfilters.renderTab=function(b){var c=document.getElementById("ak_list_contents");c.innerHTML="";for(var f=0;f<b.length;f++)akeeba.Fsfilters.addRow(b[f],c)};
akeeba.Fsfilters.renderCrumbs=function(b){var c=[],f=[akeeba.System.Text._("COM_AKEEBA_FILEFILTERS_LABEL_UIROOT"),b.root,[],""];c.push(f);var g=0;if(0<b.crumbs.length){var d=[];for(g=0;g<b.crumbs.length;g++){var e=b.crumbs[g];f=[e,b.root,d.slice(0),e];c.push(f);d.push(e)}}b=document.getElementById("ak_crumbs");b.innerHTML="";e=null;for(g=0;g<c.length;g++){e=c[g];f=document.createElement("li");var a=document.createElement("a");a.setAttribute("href","javascript:");e[0]=e[0].replace("&lt;","<").replace("&gt;",
">");a.textContent=e[0];akeeba.System.addEventListener(a,"click",function(k){return function(){var h=document.createElement("img");h.setAttribute("src",akeeba.System.getOptions("akeeba.Fsfilters.loadingGif",""));h.setAttribute("width",16);h.setAttribute("height",11);h.setAttribute("border",0);h.setAttribute("alt","Loading...");h.style.marginTop="5px";h.style.marginLeft="5px";this.appendChild(h);akeeba.Fsfilters.load({root:k[1],crumbs:k[2],node:k[3]})}}(e));f.appendChild(a);e=document.createElement("span");
e.textContent="/";f.appendChild(e);b.appendChild(f)}return d};
akeeba.Fsfilters.renderParentFolderElement=function(){var b=document.getElementById("folders"),c=document.createElement("div");c.className="folder-container folder-header";c.insertAdjacentHTML("beforeend",'<span class="folder-padding"></span>');c.insertAdjacentHTML("beforeend",'<span class="folder-padding"></span>');c.insertAdjacentHTML("beforeend",'<span class="folder-padding"></span>');c.insertAdjacentHTML("beforeend",'<span class="akion-arrow-up-a"></span>');var f=document.createElement("span");
f.className="folder-name folder-up";var g=document.getElementById("ak_crumbs").children;g=g[g.length-2].querySelector("a");f.textContent=" ("+g.textContent+")";akeeba.System.addEventListener(f,"click",function(d){return function(){akeeba.System.triggerEvent(d,"click")}}(g));c.appendChild(f);b.appendChild(c)};
akeeba.Loader.add(["akeeba.System","akeeba.Ajax"],function(){var b=akeeba.System.getOptions("akeeba.FileFilters.guiData",null);null!==b&&("list"===akeeba.System.getOptions("akeeba.FileFilters.viewType")?(akeeba.Fsfilters.render(b),akeeba.System.addEventListener("active_root","change",akeeba.Fsfilters.activeRootChanged)):(akeeba.Fsfilters.renderTab(b),akeeba.System.addEventListener("active_root","change",akeeba.Fsfilters.activeTabRootChanged)),akeeba.System.addEventListener("comAkeebaFileFiltersNuke",
"click",function(){akeeba.Fsfilters.nuke();return!1}),akeeba.System.addEventListener("comAkeebaFileFiltersAddDirectories","click",function(){akeeba.Fsfilters.addNew("directories");return!1}),akeeba.System.addEventListener("comAkeebaFileFiltersAddSkipfiles","click",function(){akeeba.Fsfilters.addNew("skipfiles");return!1}),akeeba.System.addEventListener("comAkeebaFileFiltersAddSkipdirs","click",function(){akeeba.Fsfilters.addNew("skipdirs");return!1}),akeeba.System.addEventListener("comAkeebaFileFiltersAddFiles",
"click",function(){akeeba.Fsfilters.addNew("files");return!1}))}); //# sourceMappingURL=FileFilters.min.map
