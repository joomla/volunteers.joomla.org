/*
 Copyright (c)2006-2022 Nicholas K. Dionysopoulos / Akeeba Ltd
 @license   GNU General Public License version 3, or later
*/
if("undefined"===typeof akeeba)var akeeba={};"undefined"===typeof akeeba.Transfer&&(akeeba.Transfer={lastUrl:"",lastResult:"",FtpTest:{},SftpTest:{},FtpModal:null,URLs:{},translations:{}});
akeeba.Transfer.onUrlChange=function(a){void 0===a&&(a=!1);var b=document.getElementById("akeeba-transfer-url"),c=b.value;""==c&&(document.getElementById("akeeba-transfer-lbl-url").style.display="block");"http://"!=c.substring(0,7)&&"https://"!=c.substring(0,8)&&(c="http://"+c);var f=akeeba.Transfer.lastUrl?akeeba.Transfer.lastUrl:akeeba.System.getOptions("akeeba.Transfer.lastUrl",""),e=akeeba.Transfer.lastResult?akeeba.Transfer.lastResult:akeeba.System.getOptions("akeeba.Transfer.lastResult","");
if(a||c!==f){a=document.querySelectorAll("#akeeba-transfer-row-url > div");for(i=0;i<a.length;i++)a[i].style.display="none";b.setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-btn-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-loading").style.display="inline-block";akeeba.System.doAjax({task:"checkUrl",url:c},akeeba.Transfer.applyUrlCheck,function(d){b.removeAttribute("disabled");document.getElementById("akeeba-transfer-btn-url").removeAttribute("disabled");
document.getElementById("akeeba-transfer-loading").style.display="none"},!1,1E4);return!1}akeeba.Transfer.applyUrlCheck({status:e,url:f})};
akeeba.Transfer.applyUrlCheck=function(a){var b=document.getElementById("akeeba-transfer-url");b.removeAttribute("disabled");document.getElementById("akeeba-transfer-btn-url").removeAttribute("disabled");document.getElementById("akeeba-transfer-loading").style.display="none";document.getElementById("akeeba-transfer-ftp-container").style.display="none";b.value=a.url;akeeba.Transfer.lastResult=a.status;akeeba.Transfer.lastUrl=a.url;switch(a.status){case "ok":akeeba.Transfer.showConnectionDetails();
break;case "same":document.getElementById("akeeba-transfer-err-url-same").style.display="block";break;case "invalid":document.getElementById("akeeba-transfer-err-url-invalid").style.display="block";break;case "notexists":document.getElementById("akeeba-transfer-err-url-notexists").style.display="block"}};
akeeba.Transfer.showConnectionDetails=function(){document.getElementById("akeeba-transfer-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-btn-url").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-err-url-notexists").style.display="none";document.getElementById("akeeba-transfer-ftp-container").style.display="grid";akeeba.Transfer.onTransferMethodChange();return!1};
akeeba.Transfer.onTransferMethodChange=function(a){a=document.getElementById("akeeba-transfer-ftp-method");a=a.options[a.selectedIndex].value;document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display=
"none";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-passive-container").style.display="none";document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="none";document.getElementById("akeeba-transfer-chunkmode").parentNode.style.display="none";document.getElementById("akeeba-transfer-chunksize").parentNode.style.display=
"none";document.getElementById("akeeba-transfer-apply-loading").style.display="none";"manual"!==a&&(document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display=
"grid",document.getElementById("akeeba-transfer-chunkmode").parentNode.style.display="grid",document.getElementById("akeeba-transfer-chunksize").parentNode.style.display="grid",document.getElementById("akeeba-transfer-btn-apply").parentNode.style.display="block",document.getElementById("akeeba-transfer-manualtransfer").style.display="none");if("manual"===a)document.getElementById("akeeba-transfer-btn-apply").parentNode.style.display="none",document.getElementById("akeeba-transfer-manualtransfer").style.display=
"grid";else{if("ftp"===a||"ftps"===a||"ftpcurl"===a||"ftpscurl"===a)document.getElementById("akeeba-transfer-ftp-passive-container").style.display="grid";if("ftpcurl"===a||"ftpscurl"===a)document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="grid";if("sftp"===a||"sftpcurl"===a)document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="grid",document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="grid"}};
akeeba.Transfer.applyConnection=function(){document.getElementById("akeeba-transfer-ftp-error").style.display="none";document.getElementById("akeeba-transfer-apply-loading").style.display="block";document.getElementById("akeeba-transfer-btn-apply").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-ftp-method").setAttribute("disabled","disabled");document.getElementById("akeeba-transfer-ftp-host").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-port").parentNode.style.display=
"none";document.getElementById("akeeba-transfer-ftp-username").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-password").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-pubkey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-privatekey").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-directory").parentNode.style.display="none";document.getElementById("akeeba-transfer-ftp-passive-container").style.display=
"none";document.getElementById("akeeba-transfer-ftp-passive-fix-container").style.display="none";document.getElementById("akeeba-transfer-chunkmode").parentNode.style.display="none";document.getElementById("akeeba-transfer-chunksize").parentNode.style.display="none";var a=document.getElementById("akeeba-transfer-ftp-method");a=a.options[a.selectedIndex].value;"manual"==a?(document.getElementById("akeeba-transfer-btn-apply").parentNode.style.display="none",document.getElementById("akeeba-transfer-manualtransfer").style.display=
"grid"):(a={task:"applyConnection",method:a,host:document.getElementById("akeeba-transfer-ftp-host").value,port:document.getElementById("akeeba-transfer-ftp-port").value,username:document.getElementById("akeeba-transfer-ftp-username").value,password:document.getElementById("akeeba-transfer-ftp-password").value,directory:document.getElementById("akeeba-transfer-ftp-directory").value,passive:document.getElementById("akeeba-transfer-ftp-passive1").checked?1:0,passive_fix:document.getElementById("akeeba-transfer-ftp-passive-fix1").checked?
1:0,privateKey:document.getElementById("akeeba-transfer-ftp-privatekey").value,publicKey:document.getElementById("akeeba-transfer-ftp-pubkey").value,chunkMode:document.getElementById("akeeba-transfer-chunkmode").value,chunkSize:document.getElementById("akeeba-transfer-chunksize").value},akeeba.System.doAjax(a,function(b){document.getElementById("akeeba-transfer-apply-loading").style.display="none";if(b.status)akeeba.Transfer.uploadKickstart();else{document.getElementById("akeeba-transfer-btn-apply").removeAttribute("disabled");
document.getElementById("akeeba-transfer-ftp-method").removeAttribute("disabled");var c=document.getElementById("akeeba-transfer-ftp-error"),f=document.getElementById("akeeba-transfer-ftp-error-body"),e=document.getElementById("akeeba-transfer-ftp-error-force");e&&(e.style.display="none",b.ignorable&&(e.style.display="inline-block"));f.innerHTML=b.message;c.style.display="block";akeeba.System.triggerEvent(c,"focus");akeeba.Transfer.onTransferMethodChange()}},function(b){document.getElementById("akeeba-transfer-apply-loading").style.display=
"none";document.getElementById("akeeba-transfer-btn-apply").removeAttribute("disabled");document.getElementById("akeeba-transfer-ftp-method").removeAttribute("disabled");b=document.getElementById("akeeba-transfer-ftp-error");document.getElementById("akeeba-transfer-ftp-error-body").textContent=akeeba.System.Text._("COM_AKEEBA_CONFIG_DIRECTFTP_TEST_FAIL");b.style.display="block";akeeba.System.triggerEvent(b,"focus");akeeba.Transfer.onTransferMethodChange()},!1,15E3))};
akeeba.Transfer.uploadKickstart=function(){var a=document.getElementById("akeeba-transfer-upload-lbl-kickstart"),b=document.getElementById("akeeba-transfer-upload-lbl-archive"),c=document.getElementById("akeeba-transfer-upload-error"),f=document.getElementById("akeeba-transfer-upload-error-body"),e=document.getElementById("akeeba-transfer-upload-error-force");c.style.display="none";e.style.display="none";f.innerHTML="";a.className="akeeba-label--orange";b.className="akeeba-label--grey";document.getElementById("akeeba-transfer-upload-area-kickstart").style.display=
"none";document.getElementById("akeeba-transfer-upload-area-upload").style.display="block";document.getElementById("akeeba-transfer-upload").style.display="block";akeeba.System.doAjax({task:"initialiseUpload"},function(d){d.status?akeeba.Transfer.uploadArchive(1):(e&&(e.style.display="none",d.ignorable&&(e.style.display="inline-block")),a.className="akeeba-label--red",f.innerHTML=d.message,c.style.display="block")},null,!1,15E4)};
akeeba.Transfer.uploadArchive=function(a){void 0===a&&(a=0);var b=document.getElementById("akeeba-transfer-upload-lbl-kickstart"),c=document.getElementById("akeeba-transfer-upload-lbl-archive"),f=document.getElementById("akeeba-transfer-upload-error"),e=document.getElementById("akeeba-transfer-upload-error-body");e.innerHTML="";f.style.display="none";b.className="akeeba-label--green";c.className="akeeba-label--orange";akeeba.System.doAjax({task:"upload",start:a},function(d){if(d.result)if(d.done){document.getElementById("akeeba-transfer-upload-percent").textContent=
"100 %";document.getElementById("akeeba-transfer-upload-size").innerHTML="";document.getElementById("akeeba-transfer-upload-area-kickstart").style.display="block";document.getElementById("akeeba-transfer-upload-area-upload").style.display="none";var g=document.getElementById("akeeba-transfer-url").value.replace(/\/$/,"")+"/kickstart.php";document.getElementById("akeeba-transfer-upload-btn-kickstart").setAttribute("href",g)}else{g=0;var h=1*d.totalSize;d=1*d.doneSize;0<h&&0<d&&(g=d/h*100);document.getElementById("akeeba-transfer-upload-percent").textContent=
g.toFixed(2)+"%";document.getElementById("akeeba-transfer-upload-size").textContent=d.toFixed(0)+" / "+h.toFixed(0)+" bytes";window.setTimeout(function(){akeeba.Transfer.uploadArchive(0)},50)}else c.className="akeeba-label--red",e.innerHTML=d.message,f.style.display="block"},null,!1,15E4)};
akeeba.Transfer.testFtpSftpConnection=function(){var a=document.getElementById("akeeba-transfer-ftp-method");a=a.options[a.selectedIndex].value;"ftp"===a||"ftps"===a||"ftpcurl"===a||"ftpscurl"===a?akeeba.Transfer.FtpTest.testConnection("akeeba-transfer-btn-testftp"):("sftp"===a||"sftpcurl"===a)&&akeeba.Transfer.SftpTest.testConnection("akeeba-transfer-btn-testftp");return!1};
akeeba.Loader.add(["akeeba.System","akeeba.Ajax"],function(){akeeba.System.addEventListener(document.getElementById("akeeba-transfer-ftp-method"),"change",akeeba.Transfer.onTransferMethodChange);akeeba.System.addEventListener(document.getElementById("akeeba-transfer-btn-url"),"click",function(a){a.preventDefault();akeeba.Transfer.onUrlChange(!0);return!1});if(document.getElementById("akeeba-transfer-url").value)akeeba.Transfer.onUrlChange();akeeba.System.addEventListener("akeeba-transfer-ftp-method",
"change",akeeba.Transfer.onTransferMethodChange);akeeba.System.addEventListener("akeeba-transfer-btn-apply","click",akeeba.Transfer.applyConnection);akeeba.System.addEventListener("akeeba-transfer-err-url-notexists-btn-ignore","click",akeeba.Transfer.showConnectionDetails)}); //# sourceMappingURL=Transfer.min.map
