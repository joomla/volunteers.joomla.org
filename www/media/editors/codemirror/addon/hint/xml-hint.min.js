!(function(a){"object"==typeof exports&&"object"==typeof module?a(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],a):a(CodeMirror)})((function(a){"use strict";function b(a,b,c){return c?a.indexOf(b)>=0:0==a.lastIndexOf(b,0)}function c(c,e){function f(){return{list:o,from:p?d(j.line,null==n?k.start:n):j,to:p?d(j.line,k.end):j}}var g=e&&e.schemaInfo,h=e&&e.quoteChar||'"',i=e&&e.matchInMiddle;if(g){var j=c.getCursor(),k=c.getTokenAt(j);k.end>j.ch&&(k.end=j.ch,k.string=k.string.slice(0,j.ch-k.start));var l=a.innerMode(c.getMode(),k.state);if(l.mode.xmlCurrentTag){var m,n,o=[],p=!1,q=/\btag\b/.test(k.type)&&!/>$/.test(k.string),r=q&&/^\w/.test(k.string);if(r){var s=c.getLine(j.line).slice(Math.max(0,k.start-2),k.start),t=/<\/$/.test(s)?"close":/<$/.test(s)?"open":null;t&&(n=k.start-("close"==t?2:1))}else q&&"<"==k.string?t="open":q&&"</"==k.string&&(t="close");var u=l.mode.xmlCurrentTag(l.state);if(!q&&!u||t){r&&(m=k.string),p=t;var v=l.mode.xmlCurrentContext?l.mode.xmlCurrentContext(l.state):[],l=v.length&&v[v.length-1],w=l&&g[l],x=l?w&&w.children:g["!top"];if(x&&"close"!=t)for(var y=0;y<x.length;++y)m&&!b(x[y],m,i)||o.push("<"+x[y]);else if("close"!=t)for(var z in g)!g.hasOwnProperty(z)||"!top"==z||"!attrs"==z||m&&!b(z,m,i)||o.push("<"+z);l&&(!m||"close"==t&&b(l,m,i))&&o.push("</"+l+">")}else{var w=u&&g[u.name],A=w&&w.attrs,B=g["!attrs"];if(!A&&!B)return;if(A){if(B){var C={};for(var D in B)B.hasOwnProperty(D)&&(C[D]=B[D]);for(var D in A)A.hasOwnProperty(D)&&(C[D]=A[D]);A=C}}else A=B;if("string"==k.type||"="==k.string){var E,s=c.getRange(d(j.line,Math.max(0,j.ch-60)),d(j.line,"string"==k.type?k.start:k.end)),F=s.match(/([^\s\u00a0=<>\"\']+)=$/);if(!F||!A.hasOwnProperty(F[1])||!(E=A[F[1]]))return;if("function"==typeof E&&(E=E.call(this,c)),"string"==k.type){m=k.string;var G=0;/['"]/.test(k.string.charAt(0))&&(h=k.string.charAt(0),m=k.string.slice(1),G++);var H=k.string.length;if(/['"]/.test(k.string.charAt(H-1))&&(h=k.string.charAt(H-1),m=k.string.substr(G,H-2)),G){var I=c.getLine(j.line);I.length>k.end&&I.charAt(k.end)==h&&k.end++}p=!0}var J=function(a){if(a)for(var c=0;c<a.length;++c)m&&!b(a[c],m,i)||o.push(h+a[c]+h);return f()};return E&&E.then?E.then(J):J(E)}"attribute"==k.type&&(m=k.string,p=!0);for(var K in A)!A.hasOwnProperty(K)||m&&!b(K,m,i)||o.push(K)}return f()}}}var d=a.Pos;a.registerHelper("hint","xml",c)}));